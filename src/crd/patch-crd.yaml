apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata: { name: patches.gate.bun.sh }
spec:
  group: gate.bun.sh
  names: { kind: Patch, plural: patches }
  scope: Namespaced
  versions:
  - name: v1
    served: true
    storage: true
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              package: { type: string }
              patchRef: { type: string }
              stage: { enum: [stable, canary] }
              rollout: { type: integer, minimum: 0, maximum: 100 }}